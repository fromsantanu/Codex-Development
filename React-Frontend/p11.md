# Chapter 11. Clinic patient flow app

## Introduction

We wrap up by building a clinic patient flow app that registers new patients (`/api/patients`) and shows upcoming visits (`/api/visits`). This gives backend developers a full picture of how React keeps schedules, forms, and lists in sync with the backend.

## Key Concepts

- **Two related APIs keep pace.** Use `/api/patients` for registration and `/api/visits` to show scheduled appointments.
- **Shared state connects components.** When a new patient is created, add them to the patient list so the visit schedule can reference the right name.
- **Live data feels like a wall calendar.** Put visits in a list with dates and the associated patient names so staff can plan their day.

## Step-by-step Implementation

1. **Build a patient form similar to chapter five.**

   Include `name`, `reason`, and `preferred_date`. POST to `/api/patients`, then add the response to `patients` state.

2. **Show the patient list beside the visit list.**

   ```jsx
   function ClinicOverview() {
     const [patients, setPatients] = useState([]);
     const [visits, setVisits] = useState([]);

     useEffect(() => {
       fetch('/api/patients')
         .then((res) => res.json())
         .then(setPatients);
       fetch('/api/visits')
         .then((res) => res.json())
         .then(setVisits);
     }, []);

     return (
       <div className="clinic-layout">
         <PatientForm onNewPatient={(patient) => setPatients((prev) => [...prev, patient])} />
         <VisitList visits={visits} patients={patients} />
       </div>
     );
   }
   ```

3. **Link visits to patients.**

   ```jsx
   function VisitList({ visits, patients }) {
     return (
       <ul>
         {visits.map((visit) => {
           const patient = patients.find((p) => p.id === visit.patient_id);
           return (
             <li key={visit.id}>
               {visit.date} – {patient ? patient.name : 'Unknown patient'}
             </li>
           );
         })}
       </ul>
     );
   }
   ```

4. **Keep form and schedule in sync.**

   When a new patient signs up, push them into the `patients` state so they appear in the visit list and any dropdowns.

## How to Use Codex Here

1. “Generate a patient registration form that POSTs to `/api/patients`, collects name, reason, and preferred date, and returns the saved patient.”
2. “Create a `VisitList` that fetches `/api/visits`, joins visits with patient records, and shows the date plus patient name.”
3. “Suggest a layout that keeps the form, patient list, and visit list visible in a single column or grid.”
4. “Refactor the data fetching into two hooks, `usePatients` and `useVisits`, and show how to use them together.”

## Mini-Exercise

Add a “Today’s visits” filter so only visits happening today appear, and show how you would prompt Codex to add the filter logic.
