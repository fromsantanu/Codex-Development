# Chapter 5. Building forms for creating or updating data

## Introduction

Forms let users send information back to the backend. Here we build a patient registration form that submits to `/api/patients` so the clinic staff can open a new file for every visit.

## Key Concepts

- **Controlled inputs keep form values in React state.** Like a receptionist writing each field on a clipboard before sending it to the database.
- **Form submission sends a POST or PATCH request.** The frontend packages the data and asks the backend to save it.
- **Feedback lets the user know the submission worked or failed.** Match this to a friendly “Patient saved” message or a red error at the top.

## Step-by-step Implementation

1. **Track form fields with `useState`.**

   ```jsx
   const [form, setForm] = useState({ name: '', reason: '' });

   function handleChange(event) {
     const { name, value } = event.target;
     setForm((prev) => ({ ...prev, [name]: value }));
   }
   ```

2. **Create form inputs.**

   ```jsx
   return (
     <form onSubmit={handleSubmit}>
       <label>
         Name:
         <input name="name" value={form.name} onChange={handleChange} />
       </label>
       <label>
         Visit reason:
         <input name="reason" value={form.reason} onChange={handleChange} />
       </label>
       <button type="submit">Register patient</button>
     </form>
   );
   ```

3. **Submit the form with `fetch`.**

   ```jsx
   async function handleSubmit(event) {
     event.preventDefault();
     const response = await fetch('/api/patients', {
       method: 'POST',
       headers: { 'Content-Type': 'application/json' },
       body: JSON.stringify(form),
     });
     if (response.ok) {
       // show success message
     } else {
       // show error from backend
     }
   }
   ```

4. **Sample API request.**

   ```
   POST /api/patients
   {
     "name": "Camila Flores",
     "reason": "Routine check-up"
   }
   Response:
   {
     "id": 42,
     "name": "Camila Flores",
     "reason": "Routine check-up",
     "created_at": "2025-04-10T08:22:00Z"
   }
   ```

## How to Use Codex Here

1. “Generate a React form component that tracks name and visit reason with `useState` and submits to `/api/patients` via POST.”
2. “Add validation that prevents submission when either field is empty and shows a message under the input.”
3. “Show how to reset the form after a successful submission and display a success banner.”
4. “Create a helper function that converts the form object into the shape expected by `/api/patients` before sending it.”

## Mini-Exercise

Extend the form to include a dropdown for `visit_type` (e.g., “New patient”, “Check-up”, “Follow-up”) and send that value along with the name and reason.
