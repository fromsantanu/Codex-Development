# Chapter 9. Customer Management UI

## Introduction

We combine everything into a small customer management UI with a list of customers, a detail pane, and a creation form. The backend offers `/api/customers` for listing and creating customers, and `/api/customers/{id}` for details.

## Key Concepts

- **Master-detail layout keeps list and detail side-by-side.** Think of a memo board that shows names on the left and the selected profile on the right.
- **Shared hooks keep logic clean.** Reuse `useCustomers` for the list and `useCustomerDetail` for the detail pane.
- **Forms create new records and refresh the list.** After posting to `/api/customers`, refetch the list so the table is up to date.

## Step-by-step Implementation

1. **Create a hook to load the list.**

   ```jsx
   function useCustomers() {
     const [customers, setCustomers] = useState([]);
     useEffect(() => {
       fetch('/api/customers')
         .then((res) => res.json())
         .then(setCustomers);
     }, []);
     return customers;
   }
   ```

2. **Build the master-detail layout.**

   ```jsx
   function CustomerManagement() {
     const customers = useCustomers();
     const [selectedId, setSelectedId] = useState(null);

     return (
       <div className="split">
         <CustomerList customers={customers} onSelect={setSelectedId} />
         <CustomerDetail id={selectedId} />
       </div>
     );
   }
   ```

3. **List component and detail fetch.**

   ```jsx
   function CustomerList({ customers, onSelect }) {
     return (
       <ul>
         {customers.map((customer) => (
           <li key={customer.id} onClick={() => onSelect(customer.id)}>
             {customer.name}
           </li>
         ))}
       </ul>
     );
   }

   function CustomerDetail({ id }) {
     const [detail, setDetail] = useState(null);

     useEffect(() => {
       if (!id) return;
       fetch(`/api/customers/${id}`)
         .then((res) => res.json())
         .then(setDetail);
     }, [id]);

     if (!detail) return <p>Select a customer</p>;
     return (
       <div>
         <h2>{detail.name}</h2>
         <p>Email: {detail.email}</p>
         <p>Notes: {detail.notes}</p>
       </div>
     );
   }
   ```

4. **Creation form refreshes the list.**

   After the POST to `/api/customers`, show a message and optionally call the list hook again by lifting state or passing a refresh callback.

## How to Use Codex Here

1. “Generate a `CustomerManagement` component that renders a customer list and a detail panel and fetches the selected customer’s data.”
2. “Create `CustomerList` and `CustomerDetail` child components, ensuring clicks on a row pass the `id` to the parent hook.”
3. “Add a form to create a new customer that validates the name field and resets after success.”
4. “Refactor the data fetching into shared hooks like `useCustomers` and `useCustomerDetail`.”

## Mini-Exercise

Add a “Refresh list” button that calls the customer list API again and highlights new entries with a short background flash.
