# **Chapter 27. Using Codex to Organize UI Structure**

*(Simple, beginner-friendly chapter based on your rules)*

---

## **1. Simple Introduction**

When your frontend grows bigger, the code becomes:

* long
* difficult to read
* hard to maintain

OpenAI Codex can help you automatically:

* **split big UI files into small functions**
* **organize menus and routing**
* **clean up messy state code**
* **create reusable components**

Think of Codex as a helpful assistant who can rearrange your “table full of papers” into neat folders.

---

## **2. Real-Life Analogy**

Imagine your study table is full of mixed papers:

* bills
* school notes
* bank documents
* health reports

It’s hard to find anything.

A friend helps you:

* puts bills in one folder
* notes in another
* medical documents in another

Now everything is clear.

Codex does a similar thing for your UI:

```
Before:
  One big messy file with pages, forms, state, backend calls mixed.

After Codex:
  /pages
  /components
  /utils
  Clean functions for each feature.
```

---

## **3. Key Concepts (Explained Gently)**

### **a) Splitting UI Into Smaller Functions**

Instead of writing one giant Streamlit page, split into small parts:

* `show_dashboard()`
* `show_profile()`
* `show_login_form()`

Each part becomes clean and easy.

---

### **b) Modules (Separate Files)**

You can create folders like:

```
/components
    navbar.py
    sidebar.py
/pages
    dashboard.py
    profile.py
/util
    state_tools.py
```

Codex can generate this structure automatically.

---

### **c) Simple Router**

Router = “deciding which screen to show”.

Codex can generate simple logic:

```python
if page == "Dashboard":
    show_dashboard()
elif page == "Profile":
    show_profile()
```

Or using NiceGUI pages.

---

### **d) Cleaning Up State**

If your state handling becomes messy, Codex can:

* find duplicate state values
* fix initialization problems
* rewrite state into clean functions or classes

---

## **4. Step-by-Step Explanation**

### **Step 1: Tell Codex What You Have**

You paste your messy file or folder into Codex CLI or VS Code.

### **Step 2: Ask Codex to Split Code**

You tell Codex:

> “Create small functions for each screen.”

Codex will:

* identify sections
* move code into separate functions
* reduce repetition

---

### **Step 3: Ask Codex to Create a Router**

Codex will generate a small router:

```python
def run_router(page):
    if page == "Home":
        show_home()
    elif page == "Dashboard":
        show_dashboard()
```

---

### **Step 4: Ask Codex to Organize State**

Codex can:

* move state initialization into a single place
* remove repeated code
* create helper functions like:

```python
def get_user_role():
    return st.session_state.get("role", None)
```

---

## **5. Example Code – Splitting UI Functions (Streamlit)**

Original big file (before):

```python
import streamlit as st
st.title("Clinic App")

page = st.sidebar.radio("Menu", ["Home", "Dashboard", "Patients"])

if page == "Home":
    st.write("Welcome home... big block of code here")

if page == "Dashboard":
    st.write("Lots of dashboard code here")

if page == "Patients":
    st.write("Lots of patient code here")
```

Using Codex, we generate:

```python
import streamlit as st

def show_home():
    st.title("Home")
    st.write("Welcome home...")

def show_dashboard():
    st.title("Dashboard")
    st.write("Dashboard charts and data...")

def show_patients():
    st.title("Patients")
    st.write("Patient list and tools...")

def run_app():
    st.sidebar.title("Menu")
    page = st.sidebar.radio("Go to", ["Home", "Dashboard", "Patients"])

    if page == "Home":
        show_home()
    elif page == "Dashboard":
        show_dashboard()
    elif page == "Patients":
        show_patients()

run_app()
```

Now the UI is clean and modular.

---

## **6. Example Code – NiceGUI Simple Router**

Codex can generate:

```python
from nicegui import ui

def navbar():
    with ui.row():
        ui.link("Home", '/')
        ui.link("Dashboard", '/dashboard')
        ui.link("Patients", '/patients')

@ui.page('/')
def home_page():
    navbar()
    ui.label("Welcome home!")

@ui.page('/dashboard')
def dashboard_page():
    navbar()
    ui.label("Dashboard content")

@ui.page('/patients')
def patients_page():
    navbar()
    ui.label("Patients list")

ui.run()
```

Codex can create this structure from a single messy file.

---

## **7. Refactoring Messy State Handling**

Suppose your messy code has:

* 10 repeated state checks
* forgotten initializations
* duplicate variables

Codex can simplify:

Before:

```python
if "token" not in st.session_state:
    st.session_state["token"] = ""
if "role" not in st.session_state:
    st.session_state["role"] = ""
if "user" not in st.session_state:
    st.session_state["user"] = ""
```

After Codex refactor:

```python
def init_state():
    defaults = {
        "token": "",
        "role": "",
        "user": "",
    }
    for key, value in defaults.items():
        st.session_state.setdefault(key, value)

init_state()
```

Cleaner and easier to maintain.

---

## **8. How Codex Helps You Here**

Use these ready-to-use prompts.

### **Prompt 1 — Split UI Pages**

“Split my Streamlit code into small functions: show_home(), show_dashboard(), show_profile(). Keep the logic same.”

### **Prompt 2 — Create a Navigation Router**

“Generate a simple router function for Streamlit that chooses which UI function to call based on sidebar selection.”

### **Prompt 3 — Convert to NiceGUI Router**

“Rewrite my Streamlit pages into NiceGUI @ui.page routes with separate functions.”

### **Prompt 4 — Organize State**

“Refactor my st.session_state logic. Create an init_state() function and remove duplicates.”

### **Prompt 5 — Folder Structure**

“Generate a folder structure with components/, pages/, utils/ and split my UI code accordingly.”

### **Prompt 6 — Clean Up Messy Frontend Code**

“Rewrite my frontend file to remove repetition, extract common components, and follow clean code structure.”

---

## **9. Small Text Diagram**

```
Before Codex:
   ui.py  (1100 lines)
      - dashboard code
      - patient code
      - login code
      - state checks repeated
      - messy layout

After Codex:
   /pages
      dashboard.py
      patients.py
      login.py
   /components
      navbar.py
      sidebar.py
   /utils
      state_manager.py
```

---

## **10. Mini Exercises for Students**

### **Exercise 1 — Split Into Functions**

Take a Streamlit file with 3 pages and ask Codex:

“Split into three functions and create a router.”

Paste the result and test it.

---

### **Exercise 2 — Create a Navbar Component**

Ask Codex:

“Generate a navbar() function using Streamlit that shows buttons and returns the selected page.”

Use it inside your main file.

---

### **Exercise 3 — State Cleanup**

Ask Codex to:

* detect duplicate keys in session state
* create a clean initializer function

Test the new structure.

---
