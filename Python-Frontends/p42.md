# **Chapter 42 — Project 1: Simple Customer Management System**

*(Explained in very simple, beginner-friendly language, following all rules.)*
*(Using the system prompt from the file you uploaded.)*

---

# **1. Simple Introduction**

In this project, we will build a very small **Customer Management System**.

Think of it like a shop owner managing his regular customers:

* He can **add** a new customer
* He can **edit** their details when they change phone/address
* He can **see all customers in a list**
* He can **search** to quickly find someone
* He can **view one customer’s details**

We will build:

### **Backend (FastAPI)**

A simple CRUD API for customers.

### **Frontend (Streamlit or NiceGUI)**

* A table showing all customers
* A search bar
* A form for Add / Edit
* A read-only “view details” page

And we will see **how Codex helps at every step**.

---

# **2. Real-Life Analogy**

Imagine you keep a notebook of your friends’ contact details:

* A **list page** = the index page of the notebook
* **Add/Edit form** = writing or updating a page
* **View details** = reading that page
* **Search** = flipping pages to find the right person

Our system works the same way, but on a computer.

---

# **3. Key Concepts (Explained Gently)**

### ✔️ **CRUD**

Create, Read, Update, Delete — basic actions for managing data.

### ✔️ **API**

Think of an API like a waiter.
Frontend asks: “Give me all customers.”
API goes to the “kitchen” (database) and returns the data.

### ✔️ **Frontend form**

The place where users type name, email, phone.

### ✔️ **Table**

Shows many records neatly.

---

# **4. Step-by-Step Breakdown**

### **Step 1 — Build Backend Customer APIs**

We make very simple endpoints:

* `POST /customers` → add new customer
* `GET /customers` → list customers + optional search
* `GET /customers/{id}` → view one
* `PUT /customers/{id}` → update
* `DELETE /customers/{id}` → delete

### **Step 2 — Build the Frontend Screens**

1. **List Page**

   * Table of customers
   * Search box
   * “Add Customer” button
   * “Edit” and “View” buttons

2. **Add/Edit Form**

   * Name
   * Email
   * Phone
   * Save button

3. **View Details Page**

   * Show customer info
   * Back to list button

### **Step 3 — Connect Frontend ⇄ Backend**

Use `requests` to call the API.

### **Step 4 — Use Codex to improve forms, layouts, and validation**

Codex can:

* auto-generate UI skeletons
* connect APIs
* create cleaner layout
* fix validation
* add helpful messages

---

# **5. Example Backend API (FastAPI)**

*(Very small and simple.)*

```python
from fastapi import FastAPI, HTTPException
from pydantic import BaseModel
from typing import Optional

app = FastAPI()

class Customer(BaseModel):
    name: str
    email: str
    phone: str

db = {}   # simple in-memory storage
id_counter = 1

@app.post("/customers")
def create_customer(c: Customer):
    global id_counter
    db[id_counter] = c
    id_counter += 1
    return {"id": id_counter - 1, "customer": c}

@app.get("/customers")
def list_customers(search: Optional[str] = None):
    result = []
    for cid, cust in db.items():
        if not search or search.lower() in cust.name.lower():
            result.append({"id": cid, **cust.dict()})
    return result

@app.get("/customers/{cid}")
def get_customer(cid: int):
    if cid not in db:
        raise HTTPException(404)
    return db[cid]

@app.put("/customers/{cid}")
def update_customer(cid: int, c: Customer):
    if cid not in db:
        raise HTTPException(404)
    db[cid] = c
    return {"status": "updated"}

@app.delete("/customers/{cid}")
def delete_customer(cid: int):
    if cid not in db:
        raise HTTPException(404)
    del db[cid]
    return {"status": "deleted"}
```

---

# **6. Example Frontend (NiceGUI)**

### **List Page (table + search)**

```python
from nicegui import ui
import requests

API = "http://localhost:8000"

customers = []

def load_customers(q=""):
    global customers
    r = requests.get(f"{API}/customers", params={"search": q})
    customers = r.json()
    table.rows = customers

def open_details(row):
    ui.navigate(f'/view/{row["id"]}')

def open_edit(row):
    ui.navigate(f'/edit/{row["id"]}')

with ui.page('/'):
    search = ui.input("Search").on_change(lambda e: load_customers(search.value))
    ui.button("Add Customer", on_click=lambda: ui.navigate('/add'))
    table = ui.table(columns=['id','name','email','phone'], rows=customers) \
        .add_slot('actions', lambda row: ui.row()(
            ui.button("View", on_click=lambda: open_details(row)),
            ui.button("Edit", on_click=lambda: open_edit(row)),
        ))
    load_customers()
```

---

### **Add / Edit Form**

```python
from nicegui import ui
import requests

API = "http://localhost:8000"

def customer_form(cid=None):
    data = {"name": "", "email": "", "phone": ""}

    if cid:
        r = requests.get(f"{API}/customers/{cid}")
        data = r.json()

    with ui.column():
        name = ui.input("Name", value=data['name'])
        email = ui.input("Email", value=data['email'])
        phone = ui.input("Phone", value=data['phone'])

        def save():
            body = {"name": name.value, "email": email.value, "phone": phone.value}
            if cid:
                requests.put(f"{API}/customers/{cid}", json=body)
            else:
                requests.post(f"{API}/customers", json=body)
            ui.navigate('/')

        ui.button("Save", on_click=save)
        ui.button("Cancel", on_click=lambda: ui.navigate('/'))

ui.page('/add')(lambda: customer_form())
ui.page('/edit/{cid}')(lambda cid: customer_form(int(cid)))
```

---

### **View Details Page**

```python
from nicegui import ui
import requests

API = "http://localhost:8000"

@ui.page('/view/{cid}')
def view_customer(cid: int):
    r = requests.get(f"{API}/customers/{cid}")
    c = r.json()

    with ui.card():
        ui.label(f"Name: {c['name']}")
        ui.label(f"Email: {c['email']}")
        ui.label(f"Phone: {c['phone']}")
        ui.button("Back", on_click=lambda: ui.navigate('/'))
```

---

# **7. How Codex Helps You Here**

### **Prompt 1 — Generate Customer CRUD APIs**

```
Generate FastAPI CRUD APIs for a Customer object 
(name, email, phone) with list, search, view, update, delete. 
Use simple in-memory storage for demo.
```

### **Prompt 2 — Create a NiceGUI table with search + API calls**

```
Generate a NiceGUI page that calls /customers API,
shows results in a table, adds a search box,
and buttons for View and Edit.
```

### **Prompt 3 — Build Add/Edit form**

```
Generate a NiceGUI form with name, email, phone,
and POST/PUT requests to the backend.
Include Save and Cancel buttons.
```

### **Prompt 4 — Improve layout & validation**

```
Improve this NiceGUI layout and add simple validation
like 'Name cannot be empty' and 'Email must contain @'.
```

### **Prompt 5 — Debug & clean up code**

```
Make my code cleaner and fix any mistakes.
Add comments and split into small functions.
```

---

# **8. Mini Exercises for Students**

### **Exercise 1 — Add “Address” field**

Update backend + frontend form to include an address.

### **Exercise 2 — Add Delete button**

Add a delete button on the list page.

### **Exercise 3 — Add a loading spinner**

Show “Loading…” while calling the backend.

---
