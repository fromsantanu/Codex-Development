# **Chapter 21. Using Codex to Build Dashboards Faster**

## **1. Simple Introduction**

Building dashboards normally takes time:

* writing API calls
* laying out tables and charts
* arranging columns and rows
* adding filters and refresh buttons

But **Codex can do most of this for you** if you give the right kind of prompts.

In this chapter, you will learn:

* how to ask Codex to generate complete dashboards
* prompt patterns that work well
* how to ask Codex to improve the layout
* how to combine multiple APIs into one view
* how to quickly fix or refactor dashboard code

This makes dashboard development **much faster and easier**.

---

## **2. Real-Life Analogy**

Imagine you are decorating a **shopfront**.

Normally, you would:

* select items
* arrange shelves
* arrange lights
* place a signboard

But with a *helpful assistant*, you can simply say:

> â€œSet up the front area with three main display sections.â€

And the assistant arranges everything neatly.

Codex works like that assistant.
You give clear instructions, and Codex creates:

* layout
* tables
* charts
* refresh logic
* API calls

All in one go.

---

## **3. Key Concepts (Explained Gently)**

### âœ”ï¸ Prompt Patterns

A â€œprompt patternâ€ is a formula you can reuse.
Example:

> â€œCreate a Streamlit dashboard with 3 charts using this APIâ€¦â€

Codex understands the pattern and produces full code.

---

### âœ”ï¸ Layout Improvement

Codex can rearrange:

* columns
* spacing
* grid structure
* chart size

Just ask it.

---

### âœ”ï¸ Multi-API Dashboard

You can ask:

> â€œFetch patient count from `/patients/stats` and disease data from `/patients/disease-count` and show them in the same dashboard.â€

Codex will connect everything and update it together.

---

### âœ”ï¸ Refactoring

Codex can clean messy code:

* remove duplication
* create helper functions
* organise code into sections

---

### âœ”ï¸ Limitations

Codex wonâ€™t guess the exact API responses unless you show a sample.

Always give an example response.

---

## **4. Step-by-Step Explanation**

### **Step 1: Decide what the dashboard should show**

Example:

* two charts
* one table
* refresh button

---

### **Step 2: Write a prompt using patterns**

Include:

* chart types
* API URLs
* layout instructions
* filters or search
* example responses

---

### **Step 3: Ask Codex to clean and improve layout**

After Codex shows raw output, ask:

> â€œMake the layout cleaner with wider charts and two columns.â€

---

### **Step 4: Ask to combine APIs**

Say:

> â€œAdd another API call for `/sales/categories` and show a bar chart beside the table.â€

---

### **Step 5: Ask Codex to fix errors**

If code doesnâ€™t work, simply ask:

> â€œCodex, fix the error and explain what was wrong.â€

---

### **Step 6: Save the final version**

Once it looks good, copy and use it in your project.

---

## **5. Example Prompt Patterns for Codex**

### ğŸ”¹ Pattern 1 â€” Build a Dashboard

> **â€œCodex, create a Streamlit dashboard with 3 charts using these APIs:
> `/sales/monthly`, `/sales/yearly`, `/sales/category-count`.
> Use plotly for charts and arrange them in 2 rows.â€**

---

### ğŸ”¹ Pattern 2 â€” Add Refresh Button

> **â€œCodex, add a â€˜Refresh Dataâ€™ button that reloads all API calls and updates the charts.â€**

---

### ğŸ”¹ Pattern 3 â€” Improve Layout

> **â€œCodex, make the dashboard layout cleaner by adding two columns at the top for metrics and placing charts below.â€**

---

### ğŸ”¹ Pattern 4 â€” Combine Multiple APIs

> **â€œCodex, fetch data from `/patients/stats` and `/patients/disease-count` and show
> (1) 3 metric cards,
> (2) disease bar chart,
> (3) latest patients table.â€**

---

### ğŸ”¹ Pattern 5 â€” Create NiceGUI Version

> **â€œCodex, convert this Streamlit dashboard into a NiceGUI page using `ui.plotly`, `ui.table`, and 3 columns for layout.â€**

---

### ğŸ”¹ Pattern 6 â€” Refactor for Reuse

> **â€œCodex, refactor this dashboard into functions:
> fetch_data(), draw_charts(), draw_table(), refresh().
> Make the code cleaner.â€**

---

### ğŸ”¹ Pattern 7 â€” Handle API Errors

> **â€œCodex, add try/except around each API call and show â€˜Unable to load dataâ€™ when API fails.â€**

---

## **6. Example UI Code â€“ Streamlit Generated by Codex**

A typical Codex-generated dashboard might look like:

```python
import streamlit as st
import requests
import plotly.express as px
import pandas as pd

st.title("Sales Dashboard")

# Fetch APIs
monthly = requests.get("http://localhost:8000/sales/monthly").json()
yearly = requests.get("http://localhost:8000/sales/yearly").json()
categories = requests.get("http://localhost:8000/sales/category-count").json()

df_month = pd.DataFrame({"Month": monthly["months"], "Sales": monthly["sales"]})
df_year = pd.DataFrame({"Year": yearly["years"], "Sales": yearly["sales"]})
df_cat = pd.DataFrame(categories)

# Charts
col1, col2 = st.columns(2)
col1.plotly_chart(px.bar(df_month, x="Month", y="Sales", title="Monthly Sales"))
col2.plotly_chart(px.line(df_year, x="Year", y="Sales", title="Yearly Sales Trend"))

st.subheader("Sales by Category")
st.plotly_chart(px.pie(df_cat, names="category", values="count"))
```

Codex can produce all of this with one prompt.

---

## **6b. NiceGUI Version Codex Can Generate**

```python
from nicegui import ui
import requests
import plotly.express as px

# Fetch API data
monthly = requests.get("http://localhost:8000/sales/monthly").json()
cat = requests.get("http://localhost:8000/sales/category-count").json()

fig1 = px.bar(monthly, x="months", y="sales")
fig2 = px.pie(cat, names=[r["category"] for r in cat], values=[r["count"] for r in cat])

ui.row().plotly(fig1)
ui.row().plotly(fig2)

ui.run()
```

---

## **7. How Codex Helps You Here**

Codex is extremely useful for:

### âœ” Generating full dashboard skeletons

### âœ” Organizing layout into rows and columns

### âœ” Writing all API calls

### âœ” Adding charts with correct parameters

### âœ” Combining multiple APIs

### âœ” Improving and cleaning layout

### âœ” Adding refresh buttons and auto-update

### âœ” Converting Streamlit dashboards to NiceGUI dashboards

### âœ” Debugging or rewriting code

You save **hours of manual coding** by giving a few lines of well-written prompts.

---

## **8. Mini Exercises for Students**

### ğŸŸ¦ Exercise 1

Ask Codex:

> â€œCreate a Streamlit dashboard with 2 charts and 1 table using dummy data.â€

Run the code.

---

### ğŸŸ¦ Exercise 2

Ask Codex:

> â€œImprove the layout so the table is below and charts are side by side.â€

Observe the changes.

---

### ğŸŸ¦ Exercise 3

Ask Codex:

> â€œFetch sales data from `/sales/monthly` and `/sales/category` and show both charts together.â€

---

### ğŸŸ¦ Exercise 4

Ask Codex:

> â€œConvert this Streamlit dashboard to NiceGUI using plotly charts and ui.table.â€

---

### ğŸŸ¦ Exercise 5 (Advanced)

Ask Codex:

> â€œRefactor the dashboard code into helper functions and add a refresh button that reloads all API calls.â€

---
