# **Chapter 13. Building Forms in NiceGUI**

---

## 1. Simple Introduction

In this chapter, we will build forms using **NiceGUI**.

NiceGUI lets you create **modern web UIs** using only Python.
You can easily add:

* text inputs
* dropdowns
* buttons
* simple layouts like **rows**, **columns**, and **cards**

We will learn how to:

* use `ui.input`, `ui.select`, `ui.button`
* handle button clicks (event handlers)
* call a **backend API** using `requests` or `httpx`
* show the result on the screen

We’ll use a simple example: **“Book a service visit”** (like AC repair).

---

## 2. Real-Life Analogy

Think of NiceGUI as building a **small counter inside a service center**:

* The counter has a **form**: Name, Service Type, Preferred Date.
* The customer fills these fields.
* The staff clicks a button “Book Service”.
* The staff computer sends the data to the **main system** (backend API).
* The system replies “Booking confirmed” or “Failed”.

NiceGUI is this **counter and the staff screen**, built in Python.

---

## 3. Key Concepts (Explained Gently)

### `ui.input`

A text box where the user can type.

```python
name = ui.input('Your Name')
```

---

### `ui.select`

A dropdown where the user selects one option.

```python
service = ui.select(['AC Repair', 'Electrician', 'Plumber'], label='Service Type')
```

---

### `ui.button`

A button that runs some code when clicked.

```python
ui.button('Submit', on_click=handle_submit)
```

* `handle_submit` is a **Python function**.
* This function can:

  * read the values from inputs
  * call a backend API
  * show messages

---

### Simple Layouts

NiceGUI has simple layout helpers:

* `ui.row()` → elements placed **next to each other**
* `ui.column()` → elements placed **one below another**
* `ui.card()` → a nice box around a group of elements

Example:

```python
with ui.card():
    with ui.column():
        ui.label('Booking Form')
        # inputs here
```

---

## 4. Step-by-Step: Booking Form in NiceGUI

We will build a form:

* Name (input)
* Service Type (select)
* Preferred Date (input as text for now)
* “Book Now” button

When user clicks the button:

* we collect values
* call backend `/service/book`
* show success or error

---

### Step 1 – Basic Setup

```python
from nicegui import ui

ui.label('Service Booking App')

ui.run()
```

Run this file → it starts a NiceGUI app.

---

### Step 2 – Create a Card Layout

```python
from nicegui import ui

with ui.card().classes('p-4'):
    ui.label('Book a Service')

ui.run()
```

`classes('p-4')` just adds some padding.

---

### Step 3 – Add Inputs and Button

We store references to the input components.

```python
from nicegui import ui

def book():
    # we will fill this function later
    pass

with ui.card().classes('p-4'):
    ui.label('Book a Service')

    name = ui.input('Your Name *')
    service = ui.select(
        ['AC Repair', 'Electrician', 'Plumber'],
        label='Service Type *'
    )
    date = ui.input('Preferred Date (YYYY-MM-DD) *')

    ui.button('Book Now', on_click=book)

ui.run()
```

---

### Step 4 – Implement the Event Handler and Call Backend

We use `requests` to call backend.

```python
from nicegui import ui
import requests

def book():
    if not name.value or not service.value or not date.value:
        ui.notify('Please fill all required fields', type='warning')
        return

    payload = {
        'name': name.value,
        'service': service.value,
        'date': date.value,
    }

    try:
        response = requests.post(
            'http://localhost:8000/service/book',
            json=payload,
            timeout=5
        )

        if response.status_code == 201:
            ui.notify('Booking confirmed ✅', type='positive')
        else:
            ui.notify(f'Booking failed ❌ (code {response.status_code})', type='negative')

    except Exception as e:
        ui.notify(f'Error contacting backend: {e}', type='negative')

with ui.card().classes('p-4'):
    ui.label('Book a Service')

    name = ui.input('Your Name *')
    service = ui.select(
        ['AC Repair', 'Electrician', 'Plumber'],
        label='Service Type *'
    )
    date = ui.input('Preferred Date (YYYY-MM-DD) *')

    ui.button('Book Now', on_click=book)

ui.run()
```

`ui.notify` shows small popup messages at the bottom of the screen.

---

## 5. Using `httpx` (Async Example – Optional)

If your backend is async, you can use `httpx.AsyncClient`.

Simple version:

```python
import httpx
from nicegui import ui

async def book_async():
    if not name.value or not service.value or not date.value:
        ui.notify('Please fill all required fields', type='warning')
        return

    payload = {
        'name': name.value,
        'service': service.value,
        'date': date.value,
    }

    try:
        async with httpx.AsyncClient(timeout=5) as client:
            response = await client.post(
                'http://localhost:8000/service/book',
                json=payload,
            )

        if response.status_code == 201:
            ui.notify('Booking confirmed ✅', type='positive')
        else:
            ui.notify('Booking failed ❌', type='negative')
    except Exception as e:
        ui.notify(f'Error contacting backend: {e}', type='negative')

with ui.card().classes('p-4'):
    ui.label('Book a Service (Async)')

    name = ui.input('Your Name *')
    service = ui.select(
        ['AC Repair', 'Electrician', 'Plumber'],
        label='Service Type *'
    )
    date = ui.input('Preferred Date (YYYY-MM-DD) *')

    ui.button('Book Now', on_click=book_async)

ui.run()
```

---

## 6. Simple Layout with Column and Row

We can mix `row` and `column` for better design.

```python
from nicegui import ui
import requests

def book():
    if not name.value or not service.value or not date.value:
        ui.notify('Please fill all required fields', type='warning')
        return

    payload = {
        'name': name.value,
        'service': service.value,
        'date': date.value,
    }

    try:
        response = requests.post(
            'http://localhost:8000/service/book',
            json=payload,
            timeout=5
        )
        if response.status_code == 201:
            ui.notify('Booking confirmed ✅', type='positive')
        else:
            ui.notify('Booking failed ❌', type='negative')
    except Exception as e:
        ui.notify(f'Error contacting backend: {e}', type='negative')

with ui.card().classes('p-4'):
    ui.label('Service Booking').classes('text-h6')

    with ui.column().classes('gap-2'):
        with ui.row():
            name = ui.input('Your Name *').classes('w-full')

        with ui.row():
            service = ui.select(
                ['AC Repair', 'Electrician', 'Plumber'],
                label='Service Type *'
            ).classes('w-full')

        with ui.row():
            date = ui.input('Preferred Date (YYYY-MM-DD) *').classes('w-full')

        ui.button('Book Now', on_click=book)

ui.run()
```

---

## 7. Simple Architecture Diagram

```text
Browser
   │
   ▼
NiceGUI App (ui.input, ui.select, ui.button)
   │   on_click -> book()
   ▼
Python function (book / book_async)
   │   requests / httpx
   ▼
Backend API (FastAPI / Django / etc.)
   │
   ▼
Database / Business Logic
```

---

## 8. How Codex Can Help Here

You can let Codex write most of this UI for you.

### Prompt 1 – Basic Form

> “Write a NiceGUI form using ui.input, ui.select, and ui.button for booking a service. Use a card layout and a column for arranging fields.”

---

### Prompt 2 – Add Backend Call

> “Add an event handler to this NiceGUI button that collects the form values and sends them as JSON to POST [http://localhost:8000/service/book](http://localhost:8000/service/book) using requests, and shows ui.notify messages based on response.”

---

### Prompt 3 – Use httpx Async

> “Convert this NiceGUI booking function to an async function using httpx.AsyncClient and update the button handler accordingly.”

---

### Prompt 4 – Better Layout

> “Improve this NiceGUI layout by using ui.row and ui.column to group fields and make the card look neat. Keep the code simple.”

---

### Prompt 5 – Validation Messages

> “Add validation: if any required field is empty, show ui.notify with type='warning' and do not call the backend API.”

---

## 9. Mini Exercises for Students

### Exercise 1 – Add More Fields

Add these fields:

* `ui.input('Phone Number *')`
* `ui.select(['Morning', 'Afternoon', 'Evening'], label='Preferred Time Slot *')`

Update the payload to send these to your backend.

---

### Exercise 2 – Show Response Details

Assume backend returns:

```json
{
  "status": "confirmed",
  "booking_id": "BK-2025-0001"
}
```

Display `booking_id` in the success notification.

---

### Exercise 3 – Separate Row for Buttons

Put the button in its own `ui.row()` and center it.

---

### Exercise 4 – Create Another Form

Create a **“New Customer Registration”** form in NiceGUI:

* Name
* Email
* City (select)
* “Register” button

On click, just `ui.notify` the collected data (no backend needed at first).

---
