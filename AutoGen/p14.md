# Chapter 14. Using a Search Engine

*Example: AI journalist researching articles*

---

#### 1. Why agents need a search engine

Imagine you are a **journalist**.

You want to write an article about:

* â€œHow AI is changing hospitalsâ€
* You need **recent news**, blogs, reports
* You donâ€™t know all websites by heart

What do you do?
You open **Google or Bing**, type your question, and read the results.

Now think of your **AI agent** as that journalist.

* The agent knows language very well.
* But it **does not know todayâ€™s news** by itself.
* It needs a **search engine** to explore the web.

So we give the agent a **search tool**:

> â€œHere, use this function whenever you need to look up something on the internet.â€

---

#### 2. The basic pattern: Agent â†’ Search tool â†’ Web

We follow the same safe pattern as before:

1. **User**: â€œFind recent articles about AI in healthcare and summarise them.â€
2. **Agent**: â€œI should search the web first.â€
3. **Search tool (Python function)**:

   * Calls Google/Bing search API with the query text
   * Receives structured results (titles, URLs, snippets)
   * Returns a clean list to the agent
4. **Agent**:

   * Reads those results
   * Writes a short, clear summary for the user

So the tool is like:

* A **research assistant** who goes to the library (web),
* Collects the relevant books/articles,
* Brings back a short list for the journalist agent.

---

#### 3. Designing a simple search tool

We want a Python function that:

* Takes a `query` string (like `"AI in hospitals 2025"`)
* Calls Google/Bing search API (with an API key)
* Returns a list of top results as simple text

For example, the tool can return:

* Title
* URL
* Short description/snippet

The agent will then **summarise** this list for the user.

> ğŸ”´ Note: In real life you must
>
> * Get an API key from Google/Bing
> * Follow their usage rules
> * Use their official SDK or HTTP API

Here we just show the **shape** of such a tool.

---

#### 4. Example: Bing-style web search tool + Autogen

Below is a simple **conceptual** example using a fake Bing API endpoint.
In real code, you will replace the URL and headers with real ones from the search provider.

```python
import os
import requests
from autogen import AssistantAgent, UserProxyAgent

# 1. Tool function: calls a web search API (e.g., Bing)
def web_search(query: str, max_results: int = 5) -> str:
    """
    Call a web search API with the given query and
    return a plain-text list of top results.
    """
    # Example: you would set this from environment variables
    api_key = os.environ.get("BING_API_KEY", "")
    endpoint = "https://api.bing.microsoft.com/v7.0/search"

    if not api_key:
        return "Search API key not configured."

    headers = {"Ocp-Apim-Subscription-Key": api_key}
    params = {"q": query, "count": max_results}

    try:
        response = requests.get(endpoint, headers=headers, params=params)
        response.raise_for_status()
        data = response.json()

        web_pages = data.get("webPages", {}).get("value", [])
        if not web_pages:
            return f"No search results found for: {query}"

        lines = [f"Top search results for: {query}"]
        for i, item in enumerate(web_pages, start=1):
            title = item.get("name", "No title")
            url = item.get("url", "No URL")
            snippet = item.get("snippet", "No snippet")
            lines.append(f"{i}. {title}\n   {url}\n   {snippet}\n")

        return "\n".join(lines)

    except Exception as e:
        return f"Search failed: {e}"

# 2. Wrap this as a tool for Autogen
search_tool = {
    "name": "web_search",
    "description": (
        "Search the web (e.g., via Bing) for a given text query. "
        "Useful for getting recent information and articles."
    ),
    "func": web_search,
}

# 3. Create an AI journalist agent that uses this tool
journalist_agent = AssistantAgent(
    name="journalist_agent",
    system_message=(
        "You are an AI journalist. "
        "When asked to research a topic, first use the web_search tool "
        "to get articles, then write a short, clear summary in simple language."
    ),
    tools=[search_tool],
)

# 4. User proxy to start a conversation
user = UserProxyAgent(name="user")

# 5. Example: research request
message = (
    "Find recent articles about how AI is used in hospitals, "
    "then summarise the key points in 5-6 simple sentences."
)

reply = user.initiate_chat(journalist_agent, message=message)
print("Agent reply:\n", reply)
```

In simple words:

* `web_search(...)`:

  * Talks to the Bing API
  * Gets a list of pages
  * Formats them as readable text
* `search_tool` tells the agent how and when to use this function
* `journalist_agent`:

  * Receives the userâ€™s request
  * Calls `web_search` with a suitable query
  * Reads the result list
  * Writes a summary for the user

This is exactly how you would build:

* AI journalist
* AI market researcher
* AI literature survey assistant for research papers
* AI competitor analysis assistant for a business

---

#### 5. Safety and good practice

When using search in agent systems, keep some simple rules:

* **Limit what you return**:
  Donâ€™t bring full articles, just short snippets and links.

* **Respect terms of use**:
  Use official APIs (Google Custom Search, Bing Web Search, etc.), not random scraping.

* **Be honest about freshness**:
  Your agent can say:
  â€œBased on the top 5 search results, here is a summaryâ€¦â€

---

#### 6. Takeaway

* A search engine makes your agent **less â€œblindâ€** and more **up-to-date**.
* You use a **Python search tool** as the bridge between the agent and the web.
* The agent can then:

  * Gather information
  * Summarise it
  * Present it in simple language to the user

This is very powerful for **journalism, research, business analysis, and education**.

---

#### Codex Instruction for this Chapter

> **â€œWrite a Python web search tool using Google or Bing search API (you may assume API key and endpoint exist). Then show how to register this tool in an Autogen agent so the agent can call it to research a topic and summarise the results.â€**
