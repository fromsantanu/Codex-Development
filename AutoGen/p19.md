# Chapter 19. AI Data Engineer Assistant

*(Reads CSV → Cleans Data → Builds Simple Insights)*

Most data engineering work starts with one simple activity:

**You get a CSV file.
You open it.
You clean it.
You try to understand what’s inside.**

An **AI Data Engineer Assistant** helps you do all of this automatically.

Think of it like a junior data engineer sitting next to you who says:

* “I loaded the CSV.”
* “Here are missing values.”
* “These columns look numeric.”
* “Here are simple insights you may like.”

This chapter shows how an Autogen agent can do exactly that.

---

## 1. The main idea

We will build one simple system:

* A **Data Assistant Agent**

  * Can load a CSV file
  * Can describe its structure
  * Can identify missing or strange values
  * Can calculate small insights

    * mean
    * min/max
    * unique values
    * simple correlations

For this, we use a **custom tool** (Python function) that the agent can call.

This is your first view of:

* Agents calling real Python tools
* Dataset → processed → summarized

---

## 2. What the agent should be able to do

### 2.1 Load a CSV file

* “Please load data.csv”
* Agent uses a tool function:

  * reads file
  * converts into a DataFrame
  * stores it

Real-life analogy:
Giving the data engineer an Excel file and he says “Okay, I’ve opened it.”

---

### 2.2 Clean basic issues

After loading, the agent can say:

* Which columns have missing values
* Which columns look numeric
* Which look categorical
* Suggests simple cleaning:

  * fill missing values
  * drop blank rows
  * convert types

Think of it like a helper saying:
“Column ‘Age’ has 5 blanks. Want me to fill with median?”

---

### 2.3 Build simple insights

The agent can produce:

* Column summaries
* Average values
* Count of categories
* Basic outliers
* Simple correlations

This is enough to show a beginner what **agentic data engineering** looks like.

---

## 3. Realistic workflow example

Let’s imagine a small dataset: “sales_data.csv”

> You: “Load the sales file and give me simple insights.”

Agent responds:

1. **Loaded file**

   * “Rows: 200, Columns: 6”

2. **Basic checks**

   * “Missing values in ‘discount’”
   * “Column ‘price’ looks numeric”
   * “Column ‘category’ is text”

3. **Insights**

   * “Average price: ₹1,280”
   * “Top 3 categories: Electronics, Clothing, Beauty”
   * “Correlation between discount and sales: 0.42”

This saves time for every data engineer.

---

## 4. Simple Autogen code with a data tool

*(agent loads and summarizes a dataset)*

Here is a beginner-friendly example.

We will create:

* A **tool function**: `load_and_summarize_csv()`
* An **Autogen agent** that can call this tool

```python
import pandas as pd
from autogen import AssistantAgent, UserProxyAgent, PythonAgentTool

# 1. Create a tool to load and summarize a CSV
def load_and_summarize_csv(file_path: str):
    """
    Loads a CSV file and returns a simple summary.
    """
    try:
        df = pd.read_csv(file_path)
    except Exception as e:
        return {"error": str(e)}

    summary = {
        "shape": df.shape,
        "columns": list(df.columns),
        "missing_values": df.isnull().sum().to_dict(),
        "numeric_summary": df.describe(include="number").to_dict(),
        "categorical_summary": df.describe(include="object").to_dict(),
    }

    return summary


# Wrap the function so Autogen can use it as a tool
csv_tool = PythonAgentTool(
    name="load_and_summarize_csv",
    description="Loads a CSV file and returns basic summary info.",
    func=load_and_summarize_csv,
)

# 2. Create the Data Engineer Agent with tool access
data_agent = AssistantAgent(
    name="data_engineer_agent",
    system_message=(
        "You are a data engineering assistant. "
        "You can load and summarize CSV files using the provided tool. "
        "Always explain results in simple language after calling the tool."
    ),
    tools=[csv_tool],
)

# 3. User agent who initiates the chat
user = UserProxyAgent(name="user", human_input_mode="ALWAYS")

# 4. Start the workflow
user.initiate_chat(
    data_agent,
    message="Please load './sales_data.csv' and show me simple insights."
)
```

### What this code does (in everyday words)

* We write a Python function that reads a CSV and summarizes it.
* We tell Autogen: “This is a tool the agent can call.”
* The **data engineer agent** receives your request and decides to call the tool.
* The tool returns a dictionary of summaries.
* The agent converts that into clear, friendly sentences for you.

This is a small but powerful pattern.

---

## 5. Why this is useful

For students and new data engineers:

* They learn how to inspect datasets automatically
* They see how an agent can run real Python code
* They start understanding how **AI + data tools** work together

For real teams:

* Build internal “data concierge” agents
* Ask:

  * “Which columns have the highest missing values?”
  * “Find anomalies in last month’s sales.”
  * “Suggest basic cleaning steps.”

This saves hours every day.

---

## 6. Takeaway

* A Data Engineer Agent loads CSV files, checks quality, and extracts insights.
* Tools allow the agent to run real Python functions.
* Autogen acts as the **controller** that decides when to call the tool.
* This chapter teaches the first step of **data engineering automation**.

---

## Codex Instruction Prompt for This Chapter

Give Codex this simple instruction:

> **“Create Autogen code where a data-engineer agent uses a Python tool to load and summarize a CSV file (rows, columns, missing values, numeric/categorical stats). Add helpful comments for beginners.”**
