# Chapter 12. Reading & Writing Files

*Example: AI writing a report into a `.txt` file*

---

#### 1. Why should agents work with files?

Until now, our agents mostly:

* Read your question
* Think
* Answer on the screen

But in real life, we often need to **save things**:

* Meeting notes in a `.txt` file
* Daily sales summary in a `.csv` file
* Short report for a doctor or teacher

Think of it like this:

* Your **agent** is a smart student.
* Your **files** are their **notebooks**.
* If the student never writes in the notebook, everything is forgotten after class.

So we teach the agent to:

* **Write** summaries into files (like saving homework).
* **Read** from files later (like revising notes).

---

#### 2. The basic pattern: Agent → Tool → File

We don’t let the agent directly “touch” the file system in a wild way.
Instead, we give it a **tool function** with a clear job.

Example pattern:

1. User: “Summarise this text and save it as a report.”
2. Agent: creates a summary using the LLM.
3. Agent: calls a **Python tool** like `store_summary(summary, filename)`.
4. Tool: writes the summary into a `.txt` file in a safe folder.
5. Later, another tool can **read** that file if needed.

This is like:

* You ask the agent: “Write this on page 5 of the notebook.”
* The tool is the **hand** that actually writes on the page.

---

#### 3. Designing a simple “store summary” tool

We want a function that:

* Takes the summary text
* Takes a file name (for example, `report_2025_11_24.txt`)
* Stores it inside a `summaries/` folder
* Returns a short success message

In very simple steps:

1. Make sure the folder `summaries/` exists.
2. Open a file inside that folder.
3. Write the text.
4. Close the file.
5. Tell the agent: “Saved successfully.”

---

#### 4. Example: Python tool for storing summaries

Here is a small, clear example.
Don’t worry about Autogen details too much; focus on the idea.

```python
import os
from autogen import AssistantAgent, UserProxyAgent

# 1. Python function: writes summary into a text file
def store_summary(summary: str, filename: str) -> str:
    """
    Save the given summary text into a .txt file
    inside the 'summaries' folder.
    """
    # Make sure the folder exists
    os.makedirs("summaries", exist_ok=True)

    # Force .txt extension for safety and consistency
    if not filename.endswith(".txt"):
        filename = filename + ".txt"

    file_path = os.path.join("summaries", filename)

    # Write the summary to the file
    with open(file_path, "w", encoding="utf-8") as f:
        f.write(summary)

    return f"Summary saved to {file_path}"

# 2. Register this function as a tool for the agent
store_summary_tool = {
    "name": "store_summary",
    "description": "Store a text summary in a .txt file inside the 'summaries' folder.",
    "func": store_summary,
}

# 3. Create an Autogen assistant agent that can use this tool
report_agent = AssistantAgent(
    name="report_agent",
    system_message=(
        "You write short, clear summaries. "
        "When asked to save a summary, use the store_summary tool."
    ),
    tools=[store_summary_tool],
)

# 4. User proxy to start the chat
user = UserProxyAgent(name="user")

# 5. Example usage: ask the agent to summarise and store
user_message = (
    "Here is a paragraph about our sales this month. "
    "Write a short summary and save it in a file called 'monthly_sales_report'. "
    "Text: We increased our online sales by 30% compared to last month..."
)

reply = user.initiate_chat(report_agent, message=user_message)

print("Agent reply:", reply)
```

What’s happening, in simple language:

* `store_summary(...)` is the **file-writing helper**.
* `store_summary_tool` tells the agent:

  * the tool’s **name**,
  * what it **does**,
  * which **function** to call.
* `report_agent` is a special Autogen agent that:

  * reads your long text,
  * writes a short summary,
  * calls `store_summary` with the summary and file name,
  * and then tells you where it stored the file.
* You can open the `summaries` folder and see the `.txt` file.

---

#### 5. Reading files (quick idea)

You can also create a second tool, for example:

```python
def read_summary(filename: str) -> str:
    """
    Read a summary file from the 'summaries' folder
    and return its contents.
    """
    if not filename.endswith(".txt"):
        filename = filename + ".txt"

    file_path = os.path.join("summaries", filename)

    if not os.path.exists(file_path):
        return f"No such file: {file_path}"

    with open(file_path, "r", encoding="utf-8") as f:
        content = f.read()

    return content
```

This allows:

* User: “Please read back my monthly_sales_report.”
* Agent: calls `read_summary("monthly_sales_report")`.
* Tool: returns the text, and the agent responds with it.

---

#### 6. Takeaway

* Files are like **memory notebooks** for your agents.
* A **tool function** can safely read and write `.txt` files.
* The agent uses these tools to **store summaries**, reports, logs, and more.
* This is very useful for:

  * keeping a record of conversations,
  * saving daily reports,
  * generating documents for clients, students, or doctors.

---

#### Codex Instruction for this Chapter

> **“Write Python tool function for storing summaries.”**
